/*!
 * 
 * ResponsivePics
 * 
 * @author Booreiland
 * @version 1.4.0
 * @link https://responsive.pics
 * @license undefined
 * 
 * Copyright (c) 2021 Booreiland
 * 
 * This software is released under the [MIT License](https://github.com/booreiland/responsive-pics/blob/master/LICENSE)
 */
(window.wpackioresponsivePicsfocalpointJsonp=window.wpackioresponsivePicsfocalpointJsonp||[]).push([[0],[function(t,e,a){a(1),a(2),t.exports=a(3)},function(t,e,a){var n="responsivePicsdist".replace(/[^a-zA-Z0-9_-]/g,"");a.p=window["__wpackIo".concat(n)]},function(t,e){!function(t,e,a){function n(t,e,a){var n=t;return t<e?n=e:t>a&&(n=a),n}var o="image-focal",c="image-focal__wrapper",i="image-focal__img",s="image-focal__point",f="image-focal__clickarea",u="image-focal__button",r="button",l="button-primary",d="button-disabled";t.responsivePics=t.responsivePics||{},t.responsivePics.focalPoint=function(h,m,p){var v,g,I=this;I.$el=t(h),I.el=h,I.$el.data("responsivePics.focalPoint",I),I.init=function(){I.options=t.extend({},t.responsivePics.focalPoint.defaultOptions,p),I.addInterfaceElements(),I.attachment.init(),I.focusInterface.init(),I.saveButton.init(),t(a).on("resize",I.attachment.updateDimensionData)},I.addInterfaceElements=function(){var e=t(".edit-attachment-frame .attachment-media-view .details-image, .edit-attachment-frame .image-editor .imgedit-crop-wrap img");e.addClass(i),e.wrap('<div class="'.concat(o,'"><div class="').concat(c,'"></div></div>'));var a=t(".".concat(c));a.append('<div class="'.concat(s,'"></div>')),a.append('<div class="'.concat(f,'"></div>')),v=t(".".concat(o)),g=t(".".concat(f))},I.attachment={$el:!1,id:!1,width:!1,height:!1,offset:{x:!1,y:!1},focalPoint:{x:50,y:50},init:function(){console.log("init",m),I.attachment.$el=t(".".concat(i)),I.attachment.id=m,I.attachment.getData(),I.attachment.$el.on("load",(function(){I.attachment.updateDimensionData()}))},getData:function(){var e={id:I.attachment.id};t.ajax({type:"POST",url:ajaxurl,data:{action:"get_focal_point",attachment:e},dataType:"json"}).always((function(t){if(!0===t.success&&t.data&&t.data.focal_point)try{if(void 0===t.data.focal_point.x||void 0===t.data.focal_point.y)throw new Error("no coordinates");I.attachment.focalPoint=t.data.focal_point}catch(t){console.log(t)}I.attachment.updateDimensionData(),I.focusInterface.updateStylePosition(),I.focusInterface.$el.css({display:"block"}),I.focusInterface.updateDimensionData(),I.focusInterface.updateStyleBackground()}))},updateDimensionData:function(){var t=I.attachment.$el;I.attachment.width=t.width(),I.attachment.height=t.height(),I.attachment.offset.x=t.offset().left,I.attachment.offset.y=t.offset().top}},I.focusInterface={$el:!1,width:0,height:0,radius:0,offset:{x:0,y:0},position:{x:0,y:0},clickPosition:{x:0,y:0},state:{move:!1,active:!1,hover:!1},init:function(){I.focusInterface.$el=t(".".concat(s)),g.on("mousedown",(function(t){1===t.which&&I.focusInterface.startMove(t,!0).move(t)})),I.focusInterface.$el.on("mousedown",(function(t){1===t.which&&I.focusInterface.startMove(t)})).on("mouseenter",(function(){I.focusInterface.hover(!0)})).on("mouseleave",(function(){I.focusInterface.hover(!1)})),t(e).on("mouseup",(function(t){1===t.which&&(I.focusInterface.state.move=!1,I.focusInterface.state.active=!1,v.removeClass("is-active"))})).on("mousemove",(function(t){I.focusInterface.move(t)})).on("resize",(function(){I.focusInterface.updateDimensionData().updateStyle()}))},startMove:function(t,e){return I.attachment.updateDimensionData(),I.focusInterface.updateDimensionData().updateClickPosition(t,e),I.saveButton.highlight(),v.addClass("is-active"),I.focusInterface.state.move=!0,I.focusInterface.state.active=!0,this},move:function(t){if(!1===I.focusInterface.state.move)return!1;var e={},a=I.attachment.offset,o=I.focusInterface.clickPosition;return e.x=t.pageX-a.x-o.x,e.y=t.pageY-a.y-o.y,e.x=n(e.x,0,I.attachment.width),e.y=n(e.y,0,I.attachment.height),I.attachment.focalPoint={x:e.x/I.attachment.width*100,y:e.y/I.attachment.height*100},I.focusInterface.position=e,I.focusInterface.updateStyle(),this},updateStyle:function(){return I.focusInterface.updateStylePosition(),I.focusInterface.updateStyleBackground(),this},updateStylePosition:function(){return I.focusInterface.$el.css({left:"".concat(I.attachment.focalPoint.x,"%"),top:"".concat(I.attachment.focalPoint.y,"%")}),this},updateStyleBackground:function(){var t=0-(I.focusInterface.position.x-I.focusInterface.radius),e=0-(I.focusInterface.position.y-I.focusInterface.radius);return I.focusInterface.$el.css({backgroundImage:'url("'.concat(I.attachment.$el.attr("src"),'")'),backgroundSize:"".concat(I.attachment.width,"px ").concat(I.attachment.height,"px"),backgroundPosition:"".concat(t,"px ").concat(e,"px ")}),this},updateClickPosition:function(t,e){var a={x:0,y:0};if(!0!==e){var n=I.focusInterface.offset;a.x=t.pageX-n.x,a.y=t.pageY-n.y}return I.focusInterface.clickPosition=a,this},updateDimensionData:function(){I.focusInterface.width=I.focusInterface.$el.width(),I.focusInterface.height=I.focusInterface.$el.height();var t=I.focusInterface.width/2;I.focusInterface.radius=t;var e=I.focusInterface.$el.offset();return I.focusInterface.offset={x:e.left+t,y:e.top+t},I.focusInterface.position={x:I.attachment.focalPoint.x/100*I.attachment.width,y:I.attachment.focalPoint.y/100*I.attachment.height},this},hover:function(t){I.focusInterface.state.hover=t,v.toggleClass("is-hover",t)}},I.saveButton={$el:!1,isSaving:!1,init:function(){var e='<button type="button" class="'.concat(r," ").concat(d," crop-attachment ").concat(u,'">').concat(responsivePicsL10n.saveButton,"</button>");t(I.el).find(".attachment-actions, .imgedit-submit").append(e),I.saveButton.$el=t(".".concat(u)),I.saveButton.$el.on("click",I.sendImageCropDataByAjax)},highlight:function(){I.saveButton.$el.removeClass(d).addClass(l).text(responsivePicsL10n.saveButton)},activate:function(){I.saveButton.$el.removeClass(d).removeClass(l)},disable:function(){I.saveButton.$el.removeClass(l).addClass(d)}},I.sendImageCropDataByAjax=function(){var e={id:I.attachment.id,focal_point:I.attachment.focalPoint};t.ajax({type:"POST",url:ajaxurl,data:{action:"set_focal_point",attachment:e},dataType:"json",beforeSend:function(){return!0!==I.saveButton.isSaving&&(I.saveButton.$el.text(responsivePicsL10n.saving),I.saveButton.disable(),I.saveButton.isSaving=!0,!0)}}).always((function(t){var e=responsivePicsL10n.saved;!0!==t.success&&(I.saveButton.activate(),e=responsivePicsL10n.tryAgain),I.saveButton.$el.text(e),I.saveButton.isSaving=!1}))}},t.responsivePics.focalPoint.defaultOptions={myDefaultValue:""},t.fn.initFocalPoint=function(e){return this.each((function(){new t.responsivePics.focalPoint(this,parseInt(e)).init()}))},t.responsivePics.focalPoint.initAttachment=function(e){var a=t(".attachment-details, .image-editor");if(a.find(".details-image, .imgedit-crop-wrap img").length)return a.initFocalPoint(e)}}(jQuery,window,document)},function(t,e,a){}],[[0,1]]]);
//# sourceMappingURL=admin-0edc0f77.js.map