/*!
 * 
 * ResponsivePics
 * 
 * @author Booreiland
 * @version 1.4.0
 * @link https://responsive.pics
 * @license undefined
 * 
 * Copyright (c) 2021 Booreiland
 * 
 * This software is released under the [MIT License](https://github.com/booreiland/responsive-pics/blob/master/LICENSE)
 */
(window.wpackioresponsivePicsfocalpointJsonp=window.wpackioresponsivePicsfocalpointJsonp||[]).push([[0],[function(t,e,a){a(1),a(2),t.exports=a(3)},function(t,e,a){var n="responsivePicsdist".replace(/[^a-zA-Z0-9_-]/g,"");a.p=window["__wpackIo".concat(n)]},function(t,e){!function(t,e,a){function n(t,e,a){var n=t;return t<e?n=e:t>a&&(n=a),n}var o="image-focal",c="image-focal__wrapper",i="image-focal__img",s="image-focal__point",f="image-focal__clickarea",u="image-focal__button",r="button",l="button-primary",d="button-disabled";t.responsivePics=t.responsivePics||{},t.responsivePics.focalPoint=function(h,m){var v,p,g=this;g.$el=t(h),g.el=h,g.$el.data("responsivePics.focalPoint",g),g.init=function(){g.options=t.extend({},t.responsivePics.focalPoint.defaultOptions,m),g.addInterfaceElements(),g.attachment.init(),g.focusInterface.init(),g.saveButton.init(),t(a).on("resize",g.attachment.updateDimensionData)},g.addInterfaceElements=function(){var e=t(".edit-attachment-frame .attachment-media-view .details-image, .edit-attachment-frame .image-editor .imgedit-crop-wrap img");e.addClass(i),e.wrap('<div class="'.concat(o,'"><div class="').concat(c,'"></div></div>'));var a=t(".".concat(c));a.append('<div class="'.concat(s,'"></div>')),a.append('<div class="'.concat(f,'"></div>')),v=t(".".concat(o)),p=t(".".concat(f))},g.attachment={$el:!1,id:!1,width:!1,height:!1,offset:{x:!1,y:!1},focalPoint:{x:50,y:50},init:function(){g.attachment.$el=t(".".concat(i)),g.attachment.getData(),g.attachment.$el.load((function(){g.attachment.updateDimensionData()}))},getData:function(){g.attachment.id=t(g.el).find("#attachment-id").data("id");var e={id:g.attachment.id};t.ajax({type:"POST",url:ajaxurl,data:{action:"get_focal_point",attachment:e},dataType:"json"}).always((function(t){if(!0===t.success&&t.data&&t.data.focal_point)try{if(void 0===t.data.focal_point.x||void 0===t.data.focal_point.y)throw new Error("no coordinates");g.attachment.focalPoint=t.data.focal_point}catch(t){console.log(t)}g.attachment.updateDimensionData(),g.focusInterface.updateStylePosition(),g.focusInterface.$el.css({display:"block"}),g.focusInterface.updateDimensionData(),g.focusInterface.updateStyleBackground()}))},updateDimensionData:function(){var t=g.attachment.$el;g.attachment.width=t.width(),g.attachment.height=t.height(),g.attachment.offset.x=t.offset().left,g.attachment.offset.y=t.offset().top}},g.focusInterface={$el:!1,width:0,height:0,radius:0,offset:{x:0,y:0},position:{x:0,y:0},clickPosition:{x:0,y:0},state:{move:!1,active:!1,hover:!1},init:function(){g.focusInterface.$el=t(".".concat(s)),p.on("mousedown",(function(t){1===t.which&&g.focusInterface.startMove(t,!0).move(t)})),g.focusInterface.$el.on("mousedown",(function(t){1===t.which&&g.focusInterface.startMove(t)})).on("mouseenter",(function(){g.focusInterface.hover(!0)})).on("mouseleave",(function(){g.focusInterface.hover(!1)})),t(e).on("mouseup",(function(t){1===t.which&&(g.focusInterface.state.move=!1,g.focusInterface.state.active=!1,v.removeClass("is-active"))})).on("mousemove",(function(t){g.focusInterface.move(t)})).on("resize",(function(){g.focusInterface.updateDimensionData().updateStyle()}))},startMove:function(t,e){return g.attachment.updateDimensionData(),g.focusInterface.updateDimensionData().updateClickPosition(t,e),g.saveButton.highlight(),v.addClass("is-active"),g.focusInterface.state.move=!0,g.focusInterface.state.active=!0,this},move:function(t){if(!1===g.focusInterface.state.move)return!1;var e={},a=g.attachment.offset,o=g.focusInterface.clickPosition;return e.x=t.pageX-a.x-o.x,e.y=t.pageY-a.y-o.y,e.x=n(e.x,0,g.attachment.width),e.y=n(e.y,0,g.attachment.height),g.attachment.focalPoint={x:e.x/g.attachment.width*100,y:e.y/g.attachment.height*100},g.focusInterface.position=e,g.focusInterface.updateStyle(),this},updateStyle:function(){return g.focusInterface.updateStylePosition(),g.focusInterface.updateStyleBackground(),this},updateStylePosition:function(){return g.focusInterface.$el.css({left:"".concat(g.attachment.focalPoint.x,"%"),top:"".concat(g.attachment.focalPoint.y,"%")}),this},updateStyleBackground:function(){var t=0-(g.focusInterface.position.x-g.focusInterface.radius),e=0-(g.focusInterface.position.y-g.focusInterface.radius);return g.focusInterface.$el.css({backgroundImage:'url("'.concat(g.attachment.$el.attr("src"),'")'),backgroundSize:"".concat(g.attachment.width,"px ").concat(g.attachment.height,"px"),backgroundPosition:"".concat(t,"px ").concat(e,"px ")}),this},updateClickPosition:function(t,e){var a={x:0,y:0};if(!0!==e){var n=g.focusInterface.offset;a.x=t.pageX-n.x,a.y=t.pageY-n.y}return g.focusInterface.clickPosition=a,this},updateDimensionData:function(){g.focusInterface.width=g.focusInterface.$el.width(),g.focusInterface.height=g.focusInterface.$el.height();var t=g.focusInterface.width/2;g.focusInterface.radius=t;var e=g.focusInterface.$el.offset();return g.focusInterface.offset={x:e.left+t,y:e.top+t},g.focusInterface.position={x:g.attachment.focalPoint.x/100*g.attachment.width,y:g.attachment.focalPoint.y/100*g.attachment.height},this},hover:function(t){g.focusInterface.state.hover=t,v.toggleClass("is-hover",t)}},g.saveButton={$el:!1,isSaving:!1,init:function(){var e='<button type="button" class="'.concat(r," ").concat(d," crop-attachment ").concat(u,'">').concat(responsivePicsL10n.saveButton,"</button>");t(g.el).find(".attachment-actions, .imgedit-submit").append(e),g.saveButton.$el=t(".".concat(u)),g.saveButton.$el.on("click",g.sendImageCropDataByAjax)},highlight:function(){g.saveButton.$el.removeClass(d).addClass(l).text(responsivePicsL10n.saveButton)},activate:function(){g.saveButton.$el.removeClass(d).removeClass(l)},disable:function(){g.saveButton.$el.removeClass(l).addClass(d)}},g.sendImageCropDataByAjax=function(){var e={id:g.attachment.id,focal_point:g.attachment.focalPoint};t.ajax({type:"POST",url:ajaxurl,data:{action:"set_focal_point",attachment:e},dataType:"json",beforeSend:function(){return!0!==g.saveButton.isSaving&&(g.saveButton.$el.text(responsivePicsL10n.saving),g.saveButton.disable(),g.saveButton.isSaving=!0,!0)}}).always((function(t){var e=responsivePicsL10n.saved;!0!==t.success&&(g.saveButton.activate(),e=responsivePicsL10n.tryAgain),g.saveButton.$el.text(e),g.saveButton.isSaving=!1}))}},t.responsivePics.focalPoint.defaultOptions={myDefaultValue:""},t.fn.initFocalPoint=function(e){return this.each((function(){new t.responsivePics.focalPoint(this,e).init()}))},t.responsivePics.focalPoint.initAttachment=function(t){return console.log("initAttachment",t)},t(a).on("ready",(function(){e.setInterval((function(){var e=t(".attachment-details, .image-editor");if(e.find(".details-image, .imgedit-crop-wrap img").length&&!t(".image-focal").length)try{e.initFocalPoint()}catch(t){console.log(t)}}),500)}))}(jQuery,window,document)},function(t,e,a){}],[[0,1]]]);
//# sourceMappingURL=admin-d35bf8a0.js.map