/*!
 * 
 * ResponsivePics
 * 
 * @author Booreiland
 * @version 1.4.0
 * @link https://responsive.pics
 * @license undefined
 * 
 * Copyright (c) 2021 Booreiland
 * 
 * This software is released under the [MIT License](https://github.com/booreiland/responsive-pics/blob/master/LICENSE)
 */
(window.wpackioresponsivePicsfocalpointJsonp=window.wpackioresponsivePicsfocalpointJsonp||[]).push([[0],[function(t,a,e){e(1),e(2),t.exports=e(3)},function(t,a,e){var n="responsivePicsdist".replace(/[^a-zA-Z0-9_-]/g,"");e.p=window["__wpackIo".concat(n)]},function(t,a){!function(t,a,e){function n(t,a,e){var n=t;return t<a?n=a:t>e&&(n=e),n}var o="image-focal",c="image-focal__wrapper",i="image-focal__img",s="image-focal__point",f="image-focal__clickarea",u="image-focal__button",r="button",l="button-primary",d="button-disabled";t.imageFocal=t.imageFocal||{},t.imageFocal.focalPoint=function(h,m){var v,p,g=this;g.$el=t(h),g.el=h,g.$el.data("imageFocal.focalPoint",g),g.init=function(){g.options=t.extend({},t.imageFocal.focalPoint.defaultOptions,m),g.addInterfaceElements(),g.attachment.init(),g.focusInterface.init(),g.saveButton.init(),t(e).on("resize",g.attachment.updateDimensionData)},g.addInterfaceElements=function(){var a=t(".edit-attachment-frame .attachment-media-view .details-image, .edit-attachment-frame .image-editor .imgedit-crop-wrap img");a.addClass(i),a.wrap('<div class="'.concat(o,'"><div class="').concat(c,'"></div></div>'));var e=t(".".concat(c));e.append('<div class="'.concat(s,'"></div>')),e.append('<div class="'.concat(f,'"></div>')),v=t(".".concat(o)),p=t(".".concat(f))},g.attachment={$el:!1,id:!1,width:!1,height:!1,offset:{x:!1,y:!1},focalPoint:{x:50,y:50},init:function(){g.attachment.$el=t(".".concat(i)),g.attachment.getData(),g.attachment.$el.load((function(){g.attachment.updateDimensionData()}))},getData:function(){g.attachment.id=t(g.el).find("#attachment-id").data("id");var a={id:g.attachment.id};t.ajax({type:"POST",url:ajaxurl,data:{action:"get_focal_point",attachment:a},dataType:"json"}).always((function(t){if(!0===t.success&&t.data&&t.data.focal_point)try{if(void 0===t.data.focal_point.x||void 0===t.data.focal_point.y)throw new Error("no coordinates");g.attachment.focalPoint=t.data.focal_point}catch(t){console.log(t)}g.attachment.updateDimensionData(),g.focusInterface.updateStylePosition(),g.focusInterface.$el.css({display:"block"}),g.focusInterface.updateDimensionData(),g.focusInterface.updateStyleBackground()}))},updateDimensionData:function(){var t=g.attachment.$el;g.attachment.width=t.width(),g.attachment.height=t.height(),g.attachment.offset.x=t.offset().left,g.attachment.offset.y=t.offset().top}},g.focusInterface={$el:!1,width:0,height:0,radius:0,offset:{x:0,y:0},position:{x:0,y:0},clickPosition:{x:0,y:0},state:{move:!1,active:!1,hover:!1},init:function(){g.focusInterface.$el=t(".".concat(s)),p.on("mousedown",(function(t){1===t.which&&g.focusInterface.startMove(t,!0).move(t)})),g.focusInterface.$el.on("mousedown",(function(t){1===t.which&&g.focusInterface.startMove(t)})).on("mouseenter",(function(){g.focusInterface.hover(!0)})).on("mouseleave",(function(){g.focusInterface.hover(!1)})),t(a).on("mouseup",(function(t){1===t.which&&(g.focusInterface.state.move=!1,g.focusInterface.state.active=!1,v.removeClass("is-active"))})).on("mousemove",(function(t){g.focusInterface.move(t)})).on("resize",(function(){g.focusInterface.updateDimensionData().updateStyle()}))},startMove:function(t,a){return g.attachment.updateDimensionData(),g.focusInterface.updateDimensionData().updateClickPosition(t,a),g.saveButton.highlight(),v.addClass("is-active"),g.focusInterface.state.move=!0,g.focusInterface.state.active=!0,this},move:function(t){if(!1===g.focusInterface.state.move)return!1;var a={},e=g.attachment.offset,o=g.focusInterface.clickPosition;return a.x=t.pageX-e.x-o.x,a.y=t.pageY-e.y-o.y,a.x=n(a.x,0,g.attachment.width),a.y=n(a.y,0,g.attachment.height),g.attachment.focalPoint={x:a.x/g.attachment.width*100,y:a.y/g.attachment.height*100},g.focusInterface.position=a,g.focusInterface.updateStyle(),this},updateStyle:function(){return g.focusInterface.updateStylePosition(),g.focusInterface.updateStyleBackground(),this},updateStylePosition:function(){return g.focusInterface.$el.css({left:"".concat(g.attachment.focalPoint.x,"%"),top:"".concat(g.attachment.focalPoint.y,"%")}),this},updateStyleBackground:function(){var t=0-(g.focusInterface.position.x-g.focusInterface.radius),a=0-(g.focusInterface.position.y-g.focusInterface.radius);return g.focusInterface.$el.css({backgroundImage:'url("'.concat(g.attachment.$el.attr("src"),'")'),backgroundSize:"".concat(g.attachment.width,"px ").concat(g.attachment.height,"px"),backgroundPosition:"".concat(t,"px ").concat(a,"px ")}),this},updateClickPosition:function(t,a){var e={x:0,y:0};if(!0!==a){var n=g.focusInterface.offset;e.x=t.pageX-n.x,e.y=t.pageY-n.y}return g.focusInterface.clickPosition=e,this},updateDimensionData:function(){g.focusInterface.width=g.focusInterface.$el.width(),g.focusInterface.height=g.focusInterface.$el.height();var t=g.focusInterface.width/2;g.focusInterface.radius=t;var a=g.focusInterface.$el.offset();return g.focusInterface.offset={x:a.left+t,y:a.top+t},g.focusInterface.position={x:g.attachment.focalPoint.x/100*g.attachment.width,y:g.attachment.focalPoint.y/100*g.attachment.height},this},hover:function(t){g.focusInterface.state.hover=t,v.toggleClass("is-hover",t)}},g.saveButton={$el:!1,isSaving:!1,init:function(){var a='<button type="button" class="'.concat(r," ").concat(d," crop-attachment ").concat(u,'">').concat(focalPointL10n.saveButton,"</button>");t(g.el).find(".attachment-actions, .imgedit-submit").append(a),g.saveButton.$el=t(".".concat(u)),g.saveButton.$el.on("click",g.sendImageCropDataByAjax)},highlight:function(){g.saveButton.$el.removeClass(d).addClass(l).text(focalPointL10n.saveButton)},activate:function(){g.saveButton.$el.removeClass(d).removeClass(l)},disable:function(){g.saveButton.$el.removeClass(l).addClass(d)}},g.sendImageCropDataByAjax=function(){var a={id:g.attachment.id,focal_point:g.attachment.focalPoint};t.ajax({type:"POST",url:ajaxurl,data:{action:"set_focal_point",attachment:a},dataType:"json",beforeSend:function(){return!0!==g.saveButton.isSaving&&(g.saveButton.$el.text(focalPointL10n.saving),g.saveButton.disable(),g.saveButton.isSaving=!0,!0)}}).always((function(t){var a=focalPointL10n.saved;!0!==t.success&&(g.saveButton.activate(),a=focalPointL10n.tryAgain),g.saveButton.$el.text(a),g.saveButton.isSaving=!1}))}},t.imageFocal.focalPoint.defaultOptions={myDefaultValue:""},t.fn.initFocalPoint=function(a){return this.each((function(){console.log("initFocalPoint",this),new t.imageFocal.focalPoint(this,a).init()}))},t.fn.initAttachment=function(t){console.log("initAttachment",t)},t(e).on("ready",(function(){a.setInterval((function(){var a=t(".attachment-details, .image-editor");if(console.log("interval",a),a.find(".details-image, .imgedit-crop-wrap img").length&&!t(".image-focal").length)try{console.log("try",a),a.initFocalPoint()}catch(t){console.log(t)}}),500)}))}(jQuery,window,document)},function(t,a,e){}],[[0,1]]]);
//# sourceMappingURL=admin-08d5ad68.js.map